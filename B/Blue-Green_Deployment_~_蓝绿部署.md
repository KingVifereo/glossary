
# Blue-Green Deployment

中文名：蓝绿部署/蓝绿发布。

蓝绿发布需要对服务的新版本进行**冗余部署**，一般新版本的机器规格和数量与旧版本保持一致，相当于该服务有**两套完全相同的部署环境**，只不过此时只有旧版本在对外提供服务，新版本作为热备。当服务进行版本升级时，我们只需将流量全部切换到新版本即可，旧版本作为热备。由于冗余部署的缘故，所以不必担心新版本的资源不够。如果新版本上线后出现严重的程序 BUG，那么我们只需将流量全部切回至旧版本，大大缩短故障恢复的时间。待新版本完成 BUG 修复并重新部署之后，再将旧版本的流量切换到新版本。

蓝绿发布通过使用额外的机器资源来解决服务发布期间的不可用问题，当服务新版本出现故障时，也可以快速将流量切回旧版本。

如图，某服务旧版本为 v1，对新版本 v2 进行冗余部署。版本升级时，将现有流量全部切换为新版本 v2。

![](https://img.liyunx.com/m1/TOIMGa88900318115003N.png ':size=70%')

当新版本 v2 存在程序 BUG 或者发生故障时，可以快速切回旧版本 v1。

![](https://img.liyunx.com/m1/TOIMG0369c0318115024N.png ':size=70%')

蓝绿部署的优点：

- 部署结构简单，运维方便；
- 服务升级过程操作简单，周期短。

蓝绿部署的缺点：

- 资源冗余，需要部署两套生产环境；
- 新版本故障影响范围大。

## 参考资料

- [一文读懂蓝绿发布、A/B 测试和金丝雀发布的优缺点](https://mp.weixin.qq.com/s?__biz=MzU4NzU0MDIzOQ==&amp;amp;mid=2247504103&amp;amp;idx=3&amp;amp;sn=1673a56c43b4f414a3da449a23779557&amp;amp;chksm=fde8e287ca9f6b91907936d3f5a85f7e3946e3cde79d237abde29d2db868c59e83cff27425d6&amp;amp;scene=27#wechat_redirect)


